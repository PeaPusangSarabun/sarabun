<form id="sarabanForm">
  <input type="text" name="from" placeholder="จาก" required>
  <input type="text" name="to" placeholder="ถึง" required>
  <input type="text" name="subject" placeholder="เรื่อง" required>
  <select name="category">
    <option value="ภายใน">ภายใน</option>
    <option value="ภายนอก">ภายนอก</option>
  </select>
  <input type="file" name="file" />
  <button type="submit">ส่งข้อมูล</button>
</form>

<div id="response"></div>

<script>
  document.getElementById("sarabanForm").addEventListener("submit", async function(e) {
    e.preventDefault();
    const formData = new FormData(e.target);
    const file = formData.get("file");
    
    if (file) {
      const reader = new FileReader();
      reader.onload = async function() {
        const base64 = reader.result.split(",")[1];
        formData.set("file", base64);
        sendData(formData);
      };
      reader.readAsDataURL(file);
    } else {
      sendData(formData);
    }

    async function sendData(data) {
      const res = await fetch("https://script.google.com/macros/s/AKfycbwji60xU3lyjwhbYWQDUJhUpCWxjBoz7AlKpB9oPRQJ5fNiLhpcBVYY2uD5XxVWgz4PYg/exec", {
        method: "POST",
        body: data
      });
      const text = await res.text();
      document.getElementById("response").innerText = text;
    }
  });
</script>
